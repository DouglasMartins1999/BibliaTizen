<!DOCTYPE html>
<html>

<head>
	<meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport" />
	<title>UI Components</title>
	<link href="../lib/tau/wearable/theme/default/tau.css" rel="stylesheet" />
	<link href="../lib/tau/wearable/theme/default/tau.circle.css" rel="stylesheet" />
	<script src="../lib/tau/wearable/js/tau.js"></script>
	<link href="../css/style.css" rel="stylesheet" />
	<link href="../css/style.circle.css" rel="stylesheet" />
	<script src="../js/circle-helper.js"></script>
	<script src="../js/index.js"></script>
</head>

<body>
	<div class="ui-page" id="chapter-page" data-go-to-top-button="true">
		<header class="ui-header">
			<h2 class="ui-title" id="title">test</h2>
		</header>
		<div class="ui-content">
			<ul class="ui-listview" id="chapters">
			</ul>
		</div>
	</div>
    <script src="../versions/nvi.js"></script>
    <script src="../versions/acf.js"></script>
    <script src="../versions/aa.js"></script>

	<script>
		var listHelper;
		const pageElement = document.querySelector("#chapter-page");
		
		pageElement.addEventListener("pagebeforeshow", function() {
			const url = searchParams(location.search)
			const books = Object.keys(index.books)
			const titulo = document.querySelector("#title");
			const listElement = document.querySelector("#chapters");
			
			const book = url.b || "jo";
			const vrs = url.v || "nvi";
			const options = {
				dataLength: books.length,
				bufferSize: 10
			};
			
			titulo.textContent = index.books[book];
			listHelper = tau.widget.Listview(listElement, options);
			listHelper.setListItemUpdater((elem, idx) => {
				elem.innerHTML = `<a href="./reader.html?b=${book}&v=${vrs}&c=${idx}" target="_self">Cap√≠tulo ${(idx + 1).toString().padStart(2, "0")}</a>`;
			});
		})

		pageElement.addEventListener("pagehide", function () {
			listHelper.destroy();
		});
	</script>

	<script src="../js/app.js"></script>
	<script src="../js/lowBatteryCheck.js"></script>
</body>

</html>